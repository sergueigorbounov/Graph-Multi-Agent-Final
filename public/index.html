
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chercheur, Gestionnaire, Chef et le Panier</title>
  <style>
      /* Global Breathing Animations */
      @keyframes breathe {
          0%, 100% {
              transform: scale(1);
              opacity: 1;
          }
          50% {
              transform: scale(1.03);
              opacity: 0.85;
          }
      }

      @keyframes glow {
          0%, 100% {
              text-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 255, 255, 0.4);
          }
          50% {
              text-shadow: 0 0 20px rgba(255, 255, 255, 1), 0 0 40px rgba(255, 255, 255, 0.8);
          }
      }

      @keyframes brightness {
          0%, 100% {
              filter: brightness(100%);
          }
          50% {
              filter: brightness(150%);
          }
      }

      @keyframes blurBreathe {
          0%, 100% {
              filter: blur(0px);
          }
          50% {
              filter: blur(8px);
          }
      }

      /* Background Layer Styles */
      body {
          margin: 0;
          font-family: Arial, sans-serif;
          height: 100vh;
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          overflow: hidden;
          background-color: black;
          position: relative;
      }

      body::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background:
                  radial-gradient(circle, transparent 100%, black 100%),
                  url('perenoel.webp') no-repeat center center fixed;
          background-size: cover;
          animation: brightness 8s infinite alternate ease-in-out, blurBreathe 10s infinite alternate ease-in-out;
          z-index: -1;
      }

      /* Glowing Link Styles */
      .top-right-link {
          position: absolute;
          top: 30px;
          right: 50px;
          font-size: 1.5em;
          color: white;
          text-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px rgb(255, 255, 255);
          text-decoration: none;
          font-weight: bold;
          animation: glow 4s infinite alternate ease-in-out;
      }

      .top-right-link:hover {
          color: #ffffff;
          text-shadow: 0 0 20px rgb(255, 255, 255), 0 0 100px rgb(255, 255, 255);
      }

      /* Title Styles */
      .title {
          font-size: 2.5em;
          font-weight: bold;
          color: #30bc0f;
          animation: breathe 10s infinite ease-in-out;
          -webkit-background-clip: text;

          text-shadow: 0 0 10px rgb(0, 0, 0), 0 0 20px rgb(0, 0, 0);

          margin-top: 90px;
          margin-bottom: 50px;

      }

      .container {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: space-evenly;
          width: 90%;
          height: 90%;
          animation: breathe 10s infinite ease-in-out;
          gap: 20px;
          margin-bottom: 50px;
      }

      .form {
          display: flex;
          gap: 10px;
          justify-content: center;
          align-items: center;
          width: 100%;
          max-width: 600px;
          animation: glow 10s infinite ease-in-out;
      }

      .input-field, .submit-btn, .clear-btn {
          padding: 15px;
          font-size: 16px;
          border-radius: 8px;
          animation: glow 8s infinite alternate ease-in-out;
          flex: 1;
          max-width: 200px;
      }

      .input-field {
          border: 1px solid rgba(255, 255, 255, 0.5);
          background-color: rgba(0, 0, 0, 0.5);
          color: white;
          text-align: center;
      }

      .submit-btn {
          background-color: rgba(0, 123, 255, 0.8);
          color: #fff;
          border: none;
          cursor: pointer;
      }

      .clear-btn {
          background-color: rgba(255, 76, 76, 0.8);
          color: #fff;
          border: none;
          cursor: pointer;
      }

      .logs {
          width: 80%;
          height: 50%;
          overflow-y: auto;
          background-color: rgba(18, 18, 18, 0.8);
          color: #0f0;
          padding: 15px;
          font-family: monospace;
          border-radius: 10px;
          box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
          animation: breathe 10s infinite ease-in-out;
      }

      .message {
          background-color: rgba(255, 255, 255, 0.1);
          border-radius: 8px;
          padding: 10px;
          margin: 5px 0;
          font-size: 14px;
          line-height: 1.4;
          word-wrap: break-word;
          animation: glow 6s infinite ease-in-out;
      }

      .user-message {
          align-self: flex-end;
          background-color: rgba(0, 123, 255, 0.8);
          color: white;
      }

      .system-message {
          align-self: flex-start;
          background-color: rgba(0, 0, 0, 0.7);
          color: white;
      }

      .spotify-layer {
          width: 80%;
          max-width: 700px;
          border-radius: 12px;
          animation: glow 10s infinite alternate ease-in-out;
      }

      .spotify-layer iframe {
          width: 100%;
          height: 100%;
          border-radius: 12px;
          shadow: 0 0 10px rgb(0, 0, 0), 0 0 20px rgb(0, 0, 0);

      }
  </style>
</head>
<body>
<a href="https://camerone-frontend.vercel.app/" target="_blank" class="top-right-link">NoÃ«l des Braves</a>
<div class="title">Chercheur, Gestionnaire, Chef et le Panier</div>
<div class="container">
  <div class="form">
    <input type="text" id="query" class="input-field" placeholder="Enter your query" />
    <button id="submit" class="submit-btn">Submit</button>
    <button id="clear" class="clear-btn">Clear Logs</button>
  </div>
  <div class="logs" id="logs"></div>
  <div class="spotify-layer">
    <iframe
      src="https://open.spotify.com/embed/track/6syO6UTl8QiiWADJy3Uy2d?utm_source=generator"
      frameBorder="0"
      allowfullscreen
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
      loading="lazy">
    </iframe>
  </div>
</div>
<script>
  const logsDiv = document.getElementById("logs");
  const queryInput = document.getElementById("query");
  const submitButton = document.getElementById("submit");
  const clearButton = document.getElementById("clear");

  const displayedLogs = new Set();

  const appendLog = (message, isUser = false) => {
    const timestamp = new Date().toISOString();
    const logEntry = `[${timestamp}] ${message}`;

    if (!displayedLogs.has(logEntry)) {
      const logElement = document.createElement("div");
      logElement.className = `message ${isUser ? "user-message" : "system-message"}`;
      logElement.textContent = logEntry;
      logsDiv.appendChild(logElement);

      displayedLogs.add(logEntry);
      logsDiv.scrollTop = logsDiv.scrollHeight;
    }
  };

  submitButton.addEventListener("click", async () => {
    const query = queryInput.value.trim();
    if (!query) {
      appendLog("Please enter a query.", false);
      return;
    }

    appendLog(`You: ${query}`, true);

    try {
      const response = await fetch(`/invoke?query=${encodeURIComponent(query)}`);
      const result = await response.json();

      let lastContent = "No content found.";
      if (result?.processingDetails) {
        for (const detail of result.processingDetails) {
          const state = detail?.supervisorState;
          if (state) {
            for (const key in state) {
              const messages = state[key]?.messages;
              if (messages && messages.length > 0) {
                lastContent = messages[messages.length - 1]?.kwargs?.content || lastContent;
              }
            }
          }
        }
      }

      appendLog(`Last Content: ${lastContent}`, false);
    } catch (error) {
      appendLog(`Error: ${error.message}`, false);
    }
  });

  clearButton.addEventListener("click", () => {
    logsDiv.innerHTML = "";
    displayedLogs.clear();
    appendLog("Logs cleared.", false);
  });
</script>
</body>
</html>
